(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     65113,       1762]
NotebookOptionsPosition[     62025,       1710]
NotebookOutlinePosition[     62429,       1726]
CellTagsIndexPosition[     62386,       1723]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Setting up the problem", "Subtitle",
 CellChangeTimes->{{3.9488400304955196`*^9, 
  3.948840033830393*^9}},ExpressionUUID->"942b62fb-68fb-6c44-a5ad-\
062cec93c370"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "2"}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"Set", " ", "the", " ", "number", " ", "of", " ", "hysterons"}], 
   "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"Define", " ", "symbolic", " ", "variables"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"Symbol", "[", "\"\<g\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"vars", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Symbol", "[", 
       RowBox[{"\"\<x\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"x1", ",", "x2", ",", "...", ",", "xn"}], "*)"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "the", " ", "coefficients", " ", "for", " ", "each", " ", 
    "equation"}], "*)"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coeffs", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<a\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<b\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<c\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<d\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{"\"\<k\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}], "<>", 
            RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "the", " ", "equations", " ", "with", " ", "interaction", 
    " ", "terms"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"equations", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"coeffs", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", 
       RowBox[{
        RowBox[{"vars", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "^", "3"}]}], "+", 
      RowBox[{
       RowBox[{"coeffs", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], " ", 
       RowBox[{
        RowBox[{"vars", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{"coeffs", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3"}], "]"}], "]"}], " ", 
       RowBox[{"vars", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"coeffs", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "4"}], "]"}], "]"}], " ", "g"}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"coeffs", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "5", ",", "j"}], "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"vars", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "-", 
           RowBox[{"vars", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "-", 
      RowBox[{
       RowBox[{"coeffs", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "5", ",", "i"}], "]"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vars", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "-", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"jacobian", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"equations", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Compute", " ", "the", " ", "Jacobian", " ", 
    RowBox[{"matrix", ":", 
     RowBox[{
     "the", " ", "partial", " ", "derivatives", " ", "of", " ", "each", " ", 
      "equation", " ", 
      RowBox[{"w", ".", "r", ".", "t"}], " ", "each", " ", "variable"}]}]}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "a1", ",", "b1", ",", "c1", ",", "d1", ",", "k11", ",", "k12", ",", "a2", 
     ",", "b2", ",", "c2", ",", "d2", ",", "k21", ",", "k22"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"4.4", ",", "3", ",", 
     RowBox[{"-", "4.5"}], ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "vv1", ",", "4", ",", "3", ",", 
     RowBox[{"-", "4.5"}], ",", 
     RowBox[{"-", "1"}], ",", "vv1", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"equations1", "[", 
    RowBox[{"var_", ",", "gg_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", "equations", ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vv1", "->", "var"}], ",", 
       RowBox[{"g", "->", "gg"}]}], "}"}]}], ")"}]}], 
  RowBox[{"(*", 
   RowBox[{"Constraint", " ", "equations"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"equations2", "[", "var_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"equations", ",", 
       RowBox[{"{", 
        RowBox[{"Det", "@", "jacobian"}], "}"}]}], "]"}], "/.", 
     RowBox[{"vv1", "->", "var"}]}], ")"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Constraint", " ", "equations"}], " ", "+", " ", "detJ"}], "=", 
    "0"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solutions", "[", 
   RowBox[{"var_", ",", "g_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"solutions", "[", 
    RowBox[{"var", ",", "g"}], "]"}], ":=", 
   RowBox[{"vars", "/.", 
    RowBox[{"NSolve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"equations1", "[", 
        RowBox[{"var", ",", "g"}], "]"}], "==", "0"}], ",", "vars", ",", 
      "Reals"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bifurcationpoints", "[", "var_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"vars", ",", 
       RowBox[{"{", "g", "}"}]}], "]"}], "/.", 
     RowBox[{"NSolve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"equations2", "[", "var", "]"}], "==", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"n", "+", "1"}]}], "]"}]}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{"vars", ",", 
         RowBox[{"{", "g", "}"}]}], "]"}], ",", "Reals"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", "3"}], "&&", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "<", "3"}]}], ")"}], "&"}]}],
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equationsg", "[", "var_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"D", "[", 
      RowBox[{"equations", ",", "g"}], "]"}], ")"}], "/.", 
    RowBox[{"vv1", "->", "var"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"replacementrule", "[", 
   RowBox[{"var_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"vars", ",", 
      RowBox[{"{", "g", "}"}]}], "]"}], "->", 
    RowBox[{
     RowBox[{"bifurcationpoints", "[", "var", "]"}], "[", 
     RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eigensystem", "[", 
    RowBox[{"i_", ",", "var_"}], "]"}], ":=", 
   RowBox[{"Chop", "@", 
    RowBox[{"SortBy", "[", 
     RowBox[{
      RowBox[{"Eigensystem", "[", 
       RowBox[{
        RowBox[{"jacobian", "/.", 
         RowBox[{"replacementrule", "[", 
          RowBox[{"var", ",", "i"}], "]"}]}], "/.", 
        RowBox[{"vv1", "->", "var"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}]}], 
  RowBox[{"(*", 
   RowBox[{
   "Finds", " ", "the", " ", "eigenvalues", " ", "and", " ", "eigenvectors", 
    " ", "and", " ", "sorts", " ", "so", " ", "that", " ", "the", " ", "0", 
    " ", "eigenvalue", " ", "is", " ", "last"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condition1", "[", 
   RowBox[{"i_", ",", "var_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"eigensystem", "[", 
     RowBox[{"i", ",", "var"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}], ".", 
   RowBox[{"equationsg", "[", "var", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seconderivatives", "[", "var_", "]"}], ":=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], ",", "#2"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"equations1", "[", 
       RowBox[{"var", ",", "g"}], "]"}], ",", "vars"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"condition2", "[", 
    RowBox[{"i_", ",", "var_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"eigensystem", "[", 
       RowBox[{"i", ",", "var"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"seconderivatives", "[", "var", "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "*", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"eigensystem", "[", 
             RowBox[{"i", ",", "var"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", 
              RowBox[{"-", "1"}], ",", "j"}], "]"}], "]"}], ")"}], "2"]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ")"}]}], ")"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "Fix", " ", "this", " ", "to", " ", "be", " ", "for", " ", "general", " ", 
    "number", " ", "of", " ", "hysterons"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"When", " ", "calling", " ", "this"}], ",", " ", 
    RowBox[{
    "need", " ", "to", " ", "replace", " ", "the", " ", "vars", " ", "with", 
     " ", "the", " ", "values", " ", "at", " ", "the", " ", "bifurcation", 
     " ", "point", " ", "using", " ", 
     RowBox[{"Thread", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vv1", ",", "1", ",", 
      RowBox[{"-", "4.2"}], ",", 
      RowBox[{"-", "1"}], ",", "0", ",", 
      RowBox[{"-", "3"}], ",", "2.1", ",", "1.2", ",", 
      RowBox[{"-", "4.6"}], ",", 
      RowBox[{"-", "1.2"}], ",", 
      RowBox[{"-", "3"}], ",", "0"}], "}"}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.948723624989544*^9, 3.9487236858258476`*^9}, 
   3.948723822872134*^9, {3.948723908053171*^9, 3.9487239183508186`*^9}, {
   3.948723961936238*^9, 3.948723963471197*^9}, {3.948724048010658*^9, 
   3.948724054937345*^9}, 3.9487247654678802`*^9, {3.948724977304219*^9, 
   3.948724978411082*^9}, 3.948725464549013*^9, 3.948725535664404*^9, 
   3.948725627104037*^9, 3.948725687642369*^9, {3.948731257925014*^9, 
   3.948731264844116*^9}, {3.948732198894535*^9, 3.948732259337155*^9}, {
   3.948732305060778*^9, 3.948732336246008*^9}, {3.9488376898599606`*^9, 
   3.948837701456983*^9}, 3.948840310908043*^9, 3.948848698959224*^9, 
   3.9488487660743675`*^9, 3.9488505186940536`*^9, 3.948851251066056*^9, 
   3.948852229117891*^9, 3.948852374901909*^9, 3.948852950458833*^9, 
   3.948853974288015*^9, {3.952533087925762*^9, 3.952533100324295*^9}, {
   3.9525375200443788`*^9, 3.952537520538349*^9}, {3.9535962100739765`*^9, 
   3.953596228748846*^9}, {3.953596265861473*^9, 3.953596302296097*^9}, {
   3.95359692888015*^9, 3.9535969409073563`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"6aabb174-5389-fc46-9f8f-e218945cabc7"],

Cell[CellGroupData[{

Cell["Dynamics", "Subsubsection",
 CellChangeTimes->{{3.948734634808136*^9, 
  3.9487346371747513`*^9}},ExpressionUUID->"80f4d289-0f70-9740-8e5f-\
9761e0f6f46e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dynamicsvariables", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dynamicsvariablesderivates", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"#", ",", "t"}], "]"}], "&"}], "/@", "dynamicsvariables"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initconditions", "=", 
   RowBox[{"dynamicsvariables", "/.", 
    RowBox[{"t", "->", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"replacementrule2", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"vars", "->", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}], ")"}]}], "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"check1", "[", 
    RowBox[{"var_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Drop", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"eigensystem", "[", 
       RowBox[{"i", ",", "var"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "Will", " ", "use", " ", "this", " ", "to", " ", "make", " ", "sure", " ", 
    "all", " ", "eigenvalues", " ", "are", " ", "positive", " ", "for", " ", 
    "stability"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"check2", "[", 
    RowBox[{"var_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Drop", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"bifurcationpoints", "[", "var", "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "Will", " ", "use", " ", "this", " ", "to", " ", "find", " ", "the", " ", 
    "hysteron", " ", "states", " ", "at", " ", "that", " ", "bifurcation", 
    " ", "point"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"check3", "[", 
    RowBox[{"var_", ",", "i_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"condition2", "[", 
     RowBox[{"i", ",", "var"}], "]"}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{"vars", "->", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"bifurcationpoints", "[", "var", "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}]}], "]"}]}]}], 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "checks", " ", "whether", " ", "the", " ", "point", " ", 
    "was", " ", "created", " ", "or", " ", "annihilated", " ", "depending", 
    " ", "on", " ", "the", " ", "sign", " ", "of", " ", "condition2", " ", 
    "value"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"checktable", "[", "var_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"check1", "[", 
       RowBox[{"var", ",", "i"}], "]"}], ",", 
      RowBox[{"check2", "[", 
       RowBox[{"var", ",", "i"}], "]"}], ",", 
      RowBox[{"check3", "[", 
       RowBox[{"var", ",", "i"}], "]"}], ",", 
      RowBox[{
       RowBox[{"bifurcationpoints", "[", "var", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "@", 
       RowBox[{"bifurcationpoints", "[", "var", "]"}]}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"checktabl1", "[", "var_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
   RowBox[{"checktable", "[", "var", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"checktabl2", "[", "var_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
   RowBox[{"checktable", "[", "var", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"checktabl3", "[", "var_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", 
   RowBox[{"checktable", "[", "var", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"firstcheck", "[", "var_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"AllTrue", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"checktabl1", "[", "var", "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", ">", "0"}], "&"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", 
        RowBox[{"bifurcationpoints", "[", "var", "]"}]}]}], "}"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "Here", " ", "save", " ", "a", " ", "list", " ", "first", " ", "so", " ", 
    "you", " ", 
    RowBox[{"don", "'"}], "t", " ", "have", " ", "to", " ", "run", " ", 
    "checktabl1", " ", "so", " ", "many", " ", 
    RowBox[{"times", ".", " ", 
     RowBox[{"That", "'"}]}], "s", " ", "the", " ", "culprit", " ", "of", " ",
     "taking", " ", 
    RowBox[{"long", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hysteronstates", "[", "var_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"#", ">=", "0"}], ",", "1", ",", "0"}], "]"}], "&"}], ",", 
    RowBox[{"checktabl2", "[", "var", "]"}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"newlist", "[", "var_", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"firstcheck", "[", "var", "]"}], ",", 
        RowBox[{"hysteronstates", "[", "var", "]"}], ",", 
        RowBox[{"checktabl3", "[", "var", "]"}], ",", 
        RowBox[{"bifurcationpoints", "[", "var", "]"}]}], "}"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "===", "True"}], "&"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "groups", " ", "all", " ", "the", " ", 
     "conditions", " ", "for", " ", "each", " ", "hysterons", " ", "and", " ",
      "removes", " ", "the", " ", "unstable", " ", "states", " ", 
     RowBox[{"completely", ".", " ", "To"}], " ", "keep", " ", "them", " ", 
     "in"}], ",", " ", 
    RowBox[{
     RowBox[{"we", "'"}], "d", " ", "simply", " ", "have", " ", "to", " ", 
     "remove", " ", "the", " ", "Select", " ", "function", " ", "in", " ", 
     "this", " ", 
     RowBox[{"case", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newlist2", "[", "var_", "]"}], ":=", 
  RowBox[{"MapAt", "[", 
   RowBox[{"ToString", ",", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"firstcheck", "[", "var", "]"}], ",", 
         RowBox[{"hysteronstates", "[", "var", "]"}], ",", 
         RowBox[{"checktabl3", "[", "var", "]"}]}], "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "===", "True"}], "&"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"All", ",", "2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possiblestates", "[", "var_", "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{"newlist", "[", "var", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"randomcolors", "[", "var_", "]"}], ":=", 
   RowBox[{"RandomColor", "[", 
    RowBox[{"Length", "@", 
     RowBox[{"possiblestates", "[", "var", "]"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "Need", " ", "to", " ", "revisit", " ", "this", " ", "because", " ", "I", 
    " ", "can", " ", "get", " ", "the", " ", "same", " ", "color", " ", "for",
     " ", "two", " ", "different", " ", "states"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coords", "[", "var_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "var"}], "}"}], "&"}], "/@", 
   RowBox[{"newlist", "[", "var", "]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.948734641136919*^9, 3.94873465795338*^9}, {
   3.948734716463373*^9, 3.948734724641905*^9}, {3.948734833347582*^9, 
   3.94873485882943*^9}, 3.948806389013813*^9, {3.948816649964401*^9, 
   3.948816692027546*^9}, 3.952533187735401*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"9bf9182f-35eb-cb45-9c99-87570d17b2ef"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9488256561433926`*^9, 3.9488256579104805`*^9}, {
   3.948825690439207*^9, 3.9488256906250134`*^9}, 3.9488324913058987`*^9, {
   3.948832582023369*^9, 3.9488325824230843`*^9}, {3.948850159243114*^9, 
   3.9488501602169495`*^9}, 
   3.9525331083322487`*^9},ExpressionUUID->"fb9dd0b6-fccb-3844-8a7f-\
cc6388daaedd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run the code here (n hysterons)", "Subtitle",
 CellChangeTimes->{{3.948840075714287*^9, 3.948840077434452*^9}, {
   3.9488402501546154`*^9, 3.948840253887207*^9}, 
   3.9488462366788406`*^9},ExpressionUUID->"e9395ab0-5c31-7444-80f8-\
aa0b34482c06"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vv1lims", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tolerance", "=", 
   RowBox[{"10", "^", 
    RowBox[{"-", "4"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"crossingpoints", "=", 
   RowBox[{"Sort", "@", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{
      RowBox[{"vv1", "/.", 
       RowBox[{"NSolve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"equations", "==", "0"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"equations", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x1", "->", "x11"}], ",", 
               RowBox[{"x2", "->", "x22"}]}], "}"}]}], ")"}], "==", "0"}], "&&", 
          RowBox[{
           RowBox[{"Det", "@", "jacobian"}], "==", "0"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Det", "@", "jacobian"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x1", "->", "x11"}], ",", 
               RowBox[{"x2", "->", "x22"}]}], "}"}]}], ")"}], "==", "0"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "[", "x1", "]"}], "<", "3"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "[", "x2", "]"}], "<", "3"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "[", "x11", "]"}], "<", "3"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "[", "x22", "]"}], "<", "3"}], "&&", 
          RowBox[{
           RowBox[{"vv1lims", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<=", "vv1", "<=", 
           RowBox[{"vv1lims", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{
          "x1", ",", "x2", ",", "x11", ",", "x22", ",", "g", ",", "vv1"}], 
          "}"}], ",", "Reals"}], "]"}]}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"#1", "-", "#2"}], "]"}], "<", "tolerance"}], "&"}], 
       ")"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cusppoints", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"vv1", "/.", 
     RowBox[{"NSolve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"equations", "==", "0"}], "&&", 
        RowBox[{
         RowBox[{"Det", "@", "jacobian"}], "==", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"-", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"equations", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "x1"}], "]"}]}], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"equations", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "x1"}], "]"}]], 
           RowBox[{"(", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"equations", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "x1"}], "]"}], ",", 
              "x1"}], "]"}], ")"}]}], "+", 
          RowBox[{"(", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"equations", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "x2"}], "]"}], ",", 
             "x2"}], "]"}], ")"}]}], "==", "0"}], "&&", 
        RowBox[{
         RowBox[{"Abs", "[", "x1", "]"}], "<", "3"}], "&&", 
        RowBox[{
         RowBox[{"Abs", "[", "x2", "]"}], "<", "3"}], "&&", 
        RowBox[{
         RowBox[{"vv1lims", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "<=", "vv1", "<=", 
         RowBox[{"vv1lims", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "x2", ",", "g", ",", "vv1"}], "}"}], ",", 
       "Reals"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cd2", "=", 
   RowBox[{"Sort", "@", 
    RowBox[{"Join", "[", 
     RowBox[{"crossingpoints", ",", "cusppoints"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extendedMidpoints", "[", "list_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"first", ",", "last", ",", "extendedList", ",", "offset"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"offset", "[", 
       RowBox[{"n1_", ",", "n2_"}], "]"}], ":=", 
      RowBox[{"0.05", " ", 
       RowBox[{"(", 
        RowBox[{"n2", "-", "n1"}], ")"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "5", "%", " ", "offset", " ", "of", " ", "the", " ", "difference"}], 
      "*)"}], 
     RowBox[{"first", "=", 
      RowBox[{
       RowBox[{"list", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"offset", "[", 
        RowBox[{
         RowBox[{"list", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"list", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Slightly", " ", "smaller", " ", "first", " ", "number"}], 
      "*)"}], 
     RowBox[{"last", "=", 
      RowBox[{
       RowBox[{"list", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "+", 
       RowBox[{"offset", "[", 
        RowBox[{
         RowBox[{"list", "[", 
          RowBox[{"[", 
           RowBox[{"-", "2"}], "]"}], "]"}], ",", 
         RowBox[{"list", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Slightly", " ", "larger", " ", "last", " ", "number"}], "*)"}], 
     RowBox[{"extendedList", "=", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"list", ",", "last"}], "]"}], ",", "first"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mean", "/@", 
      RowBox[{"Partition", "[", 
       RowBox[{"extendedList", ",", "2", ",", "1"}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cuspyoints", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x2", ",", "g", ",", "vv1"}], "}"}], "/.", 
     RowBox[{"NSolve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"equations", "==", "0"}], "&&", 
        RowBox[{
         RowBox[{"Det", "@", "jacobian"}], "==", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"-", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"equations", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "x1"}], "]"}]}], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"equations", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "x1"}], "]"}]], 
           RowBox[{"(", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"equations", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "x1"}], "]"}], ",", 
              "x1"}], "]"}], ")"}]}], "+", 
          RowBox[{"(", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"equations", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "x2"}], "]"}], ",", 
             "x2"}], "]"}], ")"}]}], "==", "0"}], "&&", 
        RowBox[{
         RowBox[{"Abs", "[", "x1", "]"}], "<", "3"}], "&&", 
        RowBox[{
         RowBox[{"Abs", "[", "x2", "]"}], "<", "3"}], "&&", 
        RowBox[{
         RowBox[{"vv1lims", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "<=", "vv1", "<=", 
         RowBox[{"vv1lims", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "x2", ",", "g", ",", "vv1"}], "}"}], ",", 
       "Reals"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"crossypoints", "=", 
   RowBox[{"Sort", "@", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "x1", ",", "x2", ",", "x11", ",", "x22", ",", "g", ",", "vv1"}], 
        "}"}], "/.", 
       RowBox[{"NSolve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"equations", "==", "0"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"equations", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x1", "->", "x11"}], ",", 
               RowBox[{"x2", "->", "x22"}]}], "}"}]}], ")"}], "==", "0"}], "&&", 
          RowBox[{
           RowBox[{"Det", "@", "jacobian"}], "==", "0"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Det", "@", "jacobian"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x1", "->", "x11"}], ",", 
               RowBox[{"x2", "->", "x22"}]}], "}"}]}], ")"}], "==", "0"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "[", "x1", "]"}], "<", "3"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "[", "x2", "]"}], "<", "3"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "[", "x11", "]"}], "<", "3"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "[", "x22", "]"}], "<", "3"}], "&&", 
          RowBox[{
           RowBox[{"vv1lims", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<=", "vv1", "<=", 
           RowBox[{"vv1lims", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{
          "x1", ",", "x2", ",", "x11", ",", "x22", ",", "g", ",", "vv1"}], 
          "}"}], ",", "Reals"}], "]"}]}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"#1", "-", "#2"}], "]"}], "<", "tolerance"}], "&"}], 
       ")"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"pointstocheck", "=", 
  RowBox[{
  "extendedMidpoints", "[", "cd2", "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.952533421605652*^9, 3.952533422601532*^9}, {
  3.9525338808796635`*^9, 3.9525341692864895`*^9}, {3.952534228359427*^9, 
  3.952534231537499*^9}, {3.952534291845095*^9, 3.952534308563498*^9}, {
  3.952534378412644*^9, 3.952534378705336*^9}, {3.952534521961737*^9, 
  3.952534539670763*^9}, {3.952535750440459*^9, 3.9525360052215195`*^9}, {
  3.9525361108097053`*^9, 3.9525361444431887`*^9}, {3.952536326828781*^9, 
  3.9525363436015835`*^9}, {3.952536496083206*^9, 3.952536496211635*^9}, {
  3.952536888736561*^9, 3.9525369071913037`*^9}, {3.9525372433211555`*^9, 
  3.952537247160408*^9}, {3.9535963094563046`*^9, 3.9535963117305603`*^9}, {
  3.9535969472327824`*^9, 3.9535969485427303`*^9}, {3.953597006009962*^9, 
  3.9535970582785816`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"e0d2abe0-0c47-c94a-80ff-a217944e7868"],

Cell[CellGroupData[{

Cell[BoxData["cuspyoints"], "Input",
 CellChangeTimes->{{3.9535971404637527`*^9, 3.953597141796427*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"6695f29c-ca1e-fb48-a994-01e8f318eed9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.8603709903415202`"}], ",", "0.404953225923866`", ",", 
     "1.112707308124513`", ",", "1.7208293384535018`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.40602671356741477`", ",", 
     RowBox[{"-", "0.9047561414599289`"}], ",", "1.2633266280582218`", ",", 
     "1.755708503013436`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.953596949426998*^9, 3.9535970624942474`*^9, 
  3.9535971423124657`*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"d6e47b8a-ffcc-3c41-96e9-f6752b54baaf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Eigenvalues", "[", 
    RowBox[{"jacobian", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "->", 
        RowBox[{"cuspyoints", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"x2", "->", 
        RowBox[{"cuspyoints", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"g", "->", 
        RowBox[{"cuspyoints", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ",", 
       RowBox[{"vv1", "->", 
        RowBox[{"cuspyoints", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "4"}], "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "@", "cuspyoints"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Eigenvalues", "[", 
    RowBox[{"jacobian", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "->", 
        RowBox[{"crossypoints", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"x2", "->", 
        RowBox[{"crossypoints", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"g", "->", 
        RowBox[{"crossypoints", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ",", 
       RowBox[{"vv1", "->", 
        RowBox[{"crossypoints", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "4"}], "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "@", "crossypoints"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.953597070379757*^9, 3.95359725525733*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"801da8f3-27ea-f944-85be-161931e73afa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3.4560892139451105`", ",", "0.008940889362004656`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.527568369069189`", ",", "0.01058304145161848`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.953597073024296*^9, 3.953597124038292*^9, {3.953597180356762*^9, 
   3.953597211754299*^9}, 3.9535972556180058`*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"3a73d6f4-4a77-fe41-b632-003938537c51"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"17.10797444253609`", ",", "10.752119892428297`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"16.039699483130107`", ",", "13.25461764624414`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15.883198752757057`", ",", "13.173378818923108`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14.009612246171187`", ",", "0.9691882521806705`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12.192682010950401`", ",", 
     RowBox[{"-", "0.7551905362156185`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11.870552704624842`", ",", 
     RowBox[{"-", "1.1812055983886225`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12.192682010950401`", ",", 
     RowBox[{"-", "0.7551905362156229`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14.009612246171185`", ",", "0.9691882521806521`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11.87055270462484`", ",", 
     RowBox[{"-", "1.1812055983886323`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12.027689438348418`", ",", 
     RowBox[{"-", "1.0886439991791876`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11.88365626040993`", ",", 
     RowBox[{"-", "2.0872958812419196`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13.43670623840639`", ",", 
     RowBox[{"-", "0.46936652085458835`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13.292141971239909`", ",", "0.38276921991953866`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13.230841891706019`", ",", "0.342983132098345`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11.486419894207838`", ",", 
     RowBox[{"-", "1.7602377269445866`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13.230841891706019`", ",", "0.3429831320983512`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13.354126173479258`", ",", "0.4515057147759758`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13.354126173479258`", ",", "0.4515057147759767`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11.486419894207838`", ",", 
     RowBox[{"-", "1.760237726944583`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13.316128122018352`", ",", "0.7599329864961153`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14.37586430651422`", ",", "11.948505134790146`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14.441380073843911`", ",", "11.36420349310861`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.953597073024296*^9, 3.953597124038292*^9, {3.953597180356762*^9, 
   3.953597211754299*^9}, 3.953597255621998*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"ea682eeb-e92c-9d4e-83f0-3bcb5f0baaa8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vvar", "=", 
   RowBox[{"pointstocheck", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"var", "=", "vvar"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Set", " ", "the", " ", "variable", " ", "here"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"currentnewlist", "=", 
   RowBox[{"newlist", "[", "var", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uniquestates", "=", 
   RowBox[{"possiblestates", "[", "var", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"currentcolors", "=", 
   RowBox[{"RandomColor", "[", 
    RowBox[{"Length", "@", "uniquestates"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stateColorMap", "=", 
   RowBox[{"AssociationThread", "[", 
    RowBox[{"uniquestates", "->", "currentcolors"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newlistWithColors", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "item", "}"}], ",", 
       RowBox[{"Append", "[", 
        RowBox[{"item", ",", 
         RowBox[{"stateColorMap", "[", 
          RowBox[{"item", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", 
     "currentnewlist"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shapes", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ">", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[FilledSquare]\>\"", ",", "15"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[FilledCircle]\>\"", ",", "15"}], "}"}]}], "]"}], "&"}],
     "/@", "newlistWithColors"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorsordered", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "5", "]"}], "]"}], "&"}], "/@", "newlistWithColors"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"legendLabels", "=", 
   RowBox[{"SwatchLegend", "[", 
    RowBox[{"currentcolors", ",", "uniquestates"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"List", "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "var"}], "}"}], "&"}], "/@",
        "newlistWithColors"}], ")"}]}], ",", 
    RowBox[{"PlotStyle", "->", "colorsordered"}], ",", 
    RowBox[{"PlotMarkers", "->", "shapes"}], ",", 
    RowBox[{"PlotLegends", "->", "legendLabels"}], ",", 
    RowBox[{"PlotRange", "->", "All"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"creationpoints", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
       "currentnewlist"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "n"], "*", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "<", "0"}], "&"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"annihilationpoints", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
       "currentnewlist"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "n"], "*", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ">", "0"}], "&"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "var", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pars", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Symbol", "[", 
       RowBox[{"\"\<x0\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"x1", ",", "x2", ",", "...", ",", "xn"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parameters", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"var", ",", "g", ",", "pars"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dynamicssoln", "=", 
   RowBox[{"ParametricNDSolve", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"-", "dynamicsvariablesderivates"}], "==", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"equations1", "[", 
             RowBox[{"var", ",", "g"}], "]"}], "/.", "replacementrule2"}], 
           ")"}]}], "]"}], ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"initconditions", "==", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "&"}], "/@", 
            RowBox[{"Drop", "[", 
             RowBox[{"parameters", ",", "2"}], "]"}]}], ")"}]}], "]"}]}], 
       "}"}]}], ",", "vars", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "100"}], "}"}], ",", "parameters"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sollist", "[", 
   RowBox[{"parameters_", ",", "t_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"Sequence", "@@", "parameters"}], "]"}], "[", "t", "]"}], 
      "&"}], "/@", "vars"}], ")"}], "/.", " ", 
   "dynamicssoln"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eps", "=", ".005"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Length", "@", "creationpoints"}], ",", 
     RowBox[{"Length", "@", "annihilationpoints"}]}], "}"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "limit", " ", "of", " ", "what", " ", "i", " ", "can", " ", 
    "be", " ", "when", " ", "running", " ", "the", " ", "dynamics"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"setparameter1", "[", 
   RowBox[{"var_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"var", ",", 
      RowBox[{
       RowBox[{"annihilationpoints", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}], "+", "eps"}]}], "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"annihilationpoints", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"setparameter2", "[", 
   RowBox[{"var_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"var", ",", 
      RowBox[{
       RowBox[{"creationpoints", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}], "-", "eps"}]}], "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"creationpoints", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solutionsinc", "[", 
   RowBox[{"var_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"sollist", "[", 
    RowBox[{"parameters", ",", "100"}], "]"}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"parameters", "->", 
     RowBox[{"setparameter1", "[", 
      RowBox[{"var", ",", "i"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solutionsdec", "[", 
   RowBox[{"var_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"sollist", "[", 
    RowBox[{"parameters", ",", "100"}], "]"}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"parameters", "->", 
     RowBox[{"setparameter2", "[", 
      RowBox[{"var", ",", "i"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uptransitions", "[", "var_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"annihilationpoints", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
        RowBox[{"Flatten", "@", 
         RowBox[{"solutionsinc", "[", 
          RowBox[{"var", ",", "i"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "@", "annihilationpoints"}]}], "}"}]}], "]"}], "/.",
     " ", 
    RowBox[{"x_Real", ":>", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x", ">", "0"}], ",", "1", ",", "0"}], "]"}]}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"downtransitions", "[", "var_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"creationpoints", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
        RowBox[{"Flatten", "@", 
         RowBox[{"solutionsdec", "[", 
          RowBox[{"var", ",", "i"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "@", "creationpoints"}]}], "}"}]}], "]"}], "/.", 
    " ", 
    RowBox[{"x_Real", ":>", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x", ">", "0"}], ",", "1", ",", "0"}], "]"}]}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "=", "vvar"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edges", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"uptransitions", "[", "var", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"uptransitions", "[", "var", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "annihilationpoints"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"downtransitions", "[", "var", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"downtransitions", "[", "var", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "creationpoints"}]}], "}"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graph", "[", 
  RowBox[{"edges", ",", 
   RowBox[{"VertexLabels", "->", 
    RowBox[{"(", 
     RowBox[{"v_Real", ":>", 
      RowBox[{"Style", "[", 
       RowBox[{"v", ",", 
        RowBox[{"FontSize", "->", "12"}], ",", 
        RowBox[{"Background", "->", "LightGray"}]}], "]"}]}], ")"}]}], ",", 
   RowBox[{"GraphStyle", "->", "\"\<NameLabeled\>\""}], ",", 
   RowBox[{"VertexStyle", "->", "White"}], ",", 
   RowBox[{"VertexSize", "->", "Medium"}], ",", 
   RowBox[{"EdgeStyle", "->", 
    RowBox[{"GrayLevel", "[", "0", "]"}]}], ",", 
   RowBox[{"GraphLayout", "->", "\"\<SpringEmbedding\>\""}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.94882610456817*^9, 3.948826172256111*^9}, {
   3.948826213360342*^9, 3.948826221530617*^9}, {3.948826303310499*^9, 
   3.948826304823015*^9}, {3.948826492879494*^9, 3.948826510212311*^9}, {
   3.9488337543905296`*^9, 3.948833762487425*^9}, {3.94883564301956*^9, 
   3.948835644382036*^9}, 3.948835776381617*^9, 3.948836988410336*^9, 
   3.948837142005829*^9, 3.948837202739458*^9, 3.948837351514008*^9, 
   3.9488374085972614`*^9, {3.9488374657680035`*^9, 3.948837467306095*^9}, {
   3.9488377442510185`*^9, 3.948837746485958*^9}, 3.948837803868709*^9, {
   3.948837859865689*^9, 3.948837860305118*^9}, {3.94883798395207*^9, 
   3.948837984279423*^9}, 3.948838051704331*^9, {3.948838180873312*^9, 
   3.9488381993604717`*^9}, 3.948838741898043*^9, 3.948838958362482*^9, {
   3.948839013517348*^9, 3.948839047978667*^9}, 3.948839108944556*^9, 
   3.948839205922577*^9, 3.948839362944371*^9, 3.948839413668198*^9, 
   3.9488394767661095`*^9, {3.948839531559103*^9, 3.948839535214308*^9}, 
   3.9488396879748306`*^9, 3.948839737196778*^9, 3.9488462404222546`*^9, 
   3.948851123628423*^9, {3.948853014460771*^9, 3.9488530207888737`*^9}, {
   3.952532741986038*^9, 3.95253274928582*^9}, {3.952533117027094*^9, 
   3.9525331756879067`*^9}, 3.952533235628458*^9, {3.952537189881256*^9, 
   3.952537191622059*^9}, 3.952537277046143*^9, 3.952537315804556*^9, 
   3.953596320171673*^9, 3.9535964959527454`*^9, 3.9535966067265663`*^9, 
   3.9535967656126423`*^9, 3.953596835160425*^9, {3.953596960187216*^9, 
   3.9535969699314137`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"49103a4c-209f-0c43-8a2d-42e2a879b65d"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.9525332158324356`*^9, 3.952533264515961*^9, 
  3.9525371925586243`*^9, 3.9525372689209204`*^9, 3.9525373047351017`*^9, 
  3.95253737976268*^9, 3.9535964191431313`*^9, 3.953596549575876*^9, 
  3.953596635342928*^9, 3.9535967581414566`*^9, 3.953596794764206*^9, 
  3.953596890853859*^9, 3.9535969669800453`*^9, 3.9535969975246105`*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"3dd67380-d2a9-0140-b571-98b9092f4322"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.9525332158324356`*^9, 3.952533264515961*^9, 
  3.9525371925586243`*^9, 3.9525372689209204`*^9, 3.9525373047351017`*^9, 
  3.95253737976268*^9, 3.9535964191431313`*^9, 3.953596549575876*^9, 
  3.953596635342928*^9, 3.9535967581414566`*^9, 3.953596794764206*^9, 
  3.953596890853859*^9, 3.9535969669800453`*^9, 3.953596999626564*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"3b848c08-2ce2-504a-af69-71d3b427f8bb"],

Cell[BoxData[
 TemplateBox[{
  "RandomColor", "bdmdl", 
   "\"\\!\\(\\*RowBox[{\\\"0\\\"}]\\) is not a valid model specification. \
Models can be specified through color directives patterns.\"", 2, 81, 11, 
   18625208518403233512, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.95359697253372*^9, 3.9535969996285954`*^9}},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"0e3d0679-e0a0-724e-a4bf-e4d3c541d467"],

Cell[BoxData[
 TemplateBox[{
  "ListPlot", "lpn", 
   "\"\\!\\(\\*RowBox[{\\\"currentnewlist\\\"}]\\) is not a list of numbers \
or pairs of numbers.\"", 2, 87, 12, 18625208518403233512, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.95359697253372*^9, 3.9535969996612606`*^9}},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"5ad66d01-a8d3-c34c-83ba-193c77a22939"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"currentnewlist", ",", 
   RowBox[{"PlotStyle", "\[Rule]", "currentnewlist"}], ",", 
   RowBox[{"PlotMarkers", "\[Rule]", "currentnewlist"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"SwatchLegend", "[", 
     RowBox[{
      RowBox[{"RandomColor", "[", "0", "]"}], ",", "uniquestates"}], "]"}]}], 
   ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Output",
 CellChangeTimes->{3.9525332158324356`*^9, 3.952533264515961*^9, 
  3.9525371925586243`*^9, 3.9525372689209204`*^9, 3.9525373047351017`*^9, 
  3.95253737976268*^9, 3.9535964191431313`*^9, 3.953596549575876*^9, 
  3.953596635342928*^9, 3.9535967581414566`*^9, 3.953596794764206*^9, 
  3.953596890853859*^9, 3.9535969669800453`*^9, 3.9535969996672153`*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"b9398297-467f-1b4e-b5e1-ec472c07c7cd"],

Cell[BoxData[
 TemplateBox[{
  "Select", "normal", 
   "\"Nonatomic expression expected at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Select\\\", \
\\\"[\\\", RowBox[{\\\"currentnewlist\\\", \\\",\\\", \
RowBox[{RowBox[{RowBox[{SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{\\\"-\\\", \
\\\"1\\\"}], \\\")\\\"}], \\\"n\\\"], \\\" \\\", RowBox[{\\\"#1\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]}], \\\"<\
\\\", \\\"0\\\"}], \\\"&\\\"}]}], \\\"]\\\"}]\\).\"", 2, 88, 13, 
   18625208518403233512, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.95359697253372*^9, 3.953596999669241*^9}},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"68aeb1ad-93b7-3b49-8384-e3698e58b44d"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"currentnewlist\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 88, 14, 18625208518403233512, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.95359697253372*^9, 3.9535969996741943`*^9}},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"7a4440ae-4478-f342-ac7a-6b5338ed84d5"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \
\\!\\(\\*RowBox[{RowBox[{RowBox[{SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{\\\
\"-\\\", \\\"1\\\"}], \\\")\\\"}], \\\"n\\\"], \\\" \\\", RowBox[{\\\"#1\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]}], \
\\\"<\\\", \\\"0\\\"}], \\\"&\\\"}]\\) does not exist.\"", 2, 88, 15, 
   18625208518403233512, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.95359697253372*^9, 3.953596999680216*^9}},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"9280cdd3-bb2b-b74c-b995-79a5a58453b3"],

Cell[BoxData[
 TemplateBox[{
  "Part", "argm", 
   "\"\\!\\(\\*RowBox[{\\\"Part\\\"}]\\) called with \\!\\(\\*RowBox[{\\\"0\\\
\"}]\\) arguments; \\!\\(\\*RowBox[{\\\"1\\\"}]\\) or more arguments are \
expected.\"", 2, 88, 16, 18625208518403233512, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.95359697253372*^9, 3.9535969996870594`*^9}},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"e385ceeb-e8aa-2549-91cf-4b0d357f5f3b"],

Cell[BoxData[
 TemplateBox[{
  "Select", "normal", 
   "\"Nonatomic expression expected at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Select\\\", \
\\\"[\\\", RowBox[{\\\"currentnewlist\\\", \\\",\\\", \
RowBox[{RowBox[{RowBox[{SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{\\\"-\\\", \
\\\"1\\\"}], \\\")\\\"}], \\\"n\\\"], \\\" \\\", RowBox[{\\\"#1\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]}], \\\">\
\\\", \\\"0\\\"}], \\\"&\\\"}]}], \\\"]\\\"}]\\).\"", 2, 89, 17, 
   18625208518403233512, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.95359697253372*^9, 3.9535969996920433`*^9}},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"390e59ba-93a1-f34b-8cd4-da222c3b0e53"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"currentnewlist\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 89, 18, 18625208518403233512, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.95359697253372*^9, 3.953596999697031*^9}},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"56513661-f405-cd4c-beeb-d179b205f7cb"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \
\\!\\(\\*RowBox[{RowBox[{RowBox[{SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{\\\
\"-\\\", \\\"1\\\"}], \\\")\\\"}], \\\"n\\\"], \\\" \\\", RowBox[{\\\"#1\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]}], \
\\\">\\\", \\\"0\\\"}], \\\"&\\\"}]\\) does not exist.\"", 2, 89, 19, 
   18625208518403233512, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.95359697253372*^9, 3.9535969997010117`*^9}},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"d54bdb4a-8ae3-034c-bf93-e9569b487aab"],

Cell[BoxData[
 TemplateBox[{
  "Part", "argm", 
   "\"\\!\\(\\*RowBox[{\\\"Part\\\"}]\\) called with \\!\\(\\*RowBox[{\\\"0\\\
\"}]\\) arguments; \\!\\(\\*RowBox[{\\\"1\\\"}]\\) or more arguments are \
expected.\"", 2, 89, 20, 18625208518403233512, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.95359697253372*^9, 3.9535969997073193`*^9}},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"e070c8d0-2818-564f-b742-d4efa85de394"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{}, {}]]}, 
    TagBox[GraphicsGroupBox[{{}, {}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->"NetworkGraphics",
  FormatType->TraditionalForm,
  FrameTicks->None,
  PlotRange->NCache[{{0, 
      Rational[4, 3]}, {0, 1}}, {{0, 1.3333333333333333`}, {0, 
     1}}]]], "Output",
 CellChangeTimes->{3.9525332158324356`*^9, 3.952533264515961*^9, 
  3.9525371925586243`*^9, 3.9525372689209204`*^9, 3.9525373047351017`*^9, 
  3.95253737976268*^9, 3.9535964191431313`*^9, 3.953596549575876*^9, 
  3.953596635342928*^9, 3.9535967581414566`*^9, 3.953596794764206*^9, 
  3.953596890853859*^9, 3.9535969669800453`*^9, 3.953596999715328*^9},
 CellLabel->
  "Out[105]=",ExpressionUUID->"b2f4cc12-4d05-cb49-b212-2b787c9d751e"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1428, 741.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"89700eda-208d-3744-b51f-eca8f7aba54c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 170, 3, 53, "Subtitle",ExpressionUUID->"942b62fb-68fb-6c44-a5ad-062cec93c370"],
Cell[753, 27, 12850, 363, 564, "Input",ExpressionUUID->"6aabb174-5389-fc46-9f8f-e218945cabc7"],
Cell[CellGroupData[{
Cell[13628, 394, 161, 3, 45, "Subsubsection",ExpressionUUID->"80f4d289-0f70-9740-8e5f-9761e0f6f46e"],
Cell[13792, 399, 8534, 238, 447, "Input",ExpressionUUID->"9bf9182f-35eb-cb45-9c99-87570d17b2ef"],
Cell[22329, 639, 361, 6, 28, "Input",ExpressionUUID->"fb9dd0b6-fccb-3844-8a7f-cc6388daaedd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22739, 651, 254, 4, 53, "Subtitle",ExpressionUUID->"e9395ab0-5c31-7444-80f8-aa0b34482c06"],
Cell[22996, 657, 10849, 295, 622, "Input",ExpressionUUID->"e0d2abe0-0c47-c94a-80ff-a217944e7868"],
Cell[CellGroupData[{
Cell[33870, 956, 187, 3, 28, "Input",ExpressionUUID->"6695f29c-ca1e-fb48-a994-01e8f318eed9"],
Cell[34060, 961, 583, 14, 32, "Output",ExpressionUUID->"d6e47b8a-ffcc-3c41-96e9-f6752b54baaf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34680, 980, 1886, 54, 48, "Input",ExpressionUUID->"801da8f3-27ea-f944-85be-161931e73afa"],
Cell[36569, 1036, 472, 12, 32, "Output",ExpressionUUID->"3a73d6f4-4a77-fe41-b632-003938537c51"],
Cell[37044, 1050, 2550, 61, 71, "Output",ExpressionUUID->"ea682eeb-e92c-9d4e-83f0-3bcb5f0baaa8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39631, 1116, 13997, 399, 662, "Input",ExpressionUUID->"49103a4c-209f-0c43-8a2d-42e2a879b65d"],
Cell[53631, 1517, 469, 6, 32, "Output",ExpressionUUID->"3dd67380-d2a9-0140-b571-98b9092f4322"],
Cell[54103, 1525, 467, 6, 32, "Output",ExpressionUUID->"3b848c08-2ce2-504a-af69-71d3b427f8bb"],
Cell[54573, 1533, 454, 10, 28, "Message",ExpressionUUID->"0e3d0679-e0a0-724e-a4bf-e4d3c541d467"],
Cell[55030, 1545, 409, 9, 28, "Message",ExpressionUUID->"5ad66d01-a8d3-c34c-83ba-193c77a22939"],
Cell[55442, 1556, 870, 16, 32, "Output",ExpressionUUID->"b9398297-467f-1b4e-b5e1-ec472c07c7cd"],
Cell[56315, 1574, 772, 15, 28, "Message",ExpressionUUID->"68aeb1ad-93b7-3b49-8384-e3698e58b44d"],
Cell[57090, 1591, 486, 10, 28, "Message",ExpressionUUID->"7a4440ae-4478-f342-ac7a-6b5338ed84d5"],
Cell[57579, 1603, 650, 13, 28, "Message",ExpressionUUID->"9280cdd3-bb2b-b74c-b995-79a5a58453b3"],
Cell[58232, 1618, 471, 10, 28, "Message",ExpressionUUID->"e385ceeb-e8aa-2549-91cf-4b0d357f5f3b"],
Cell[58706, 1630, 774, 15, 28, "Message",ExpressionUUID->"390e59ba-93a1-f34b-8cd4-da222c3b0e53"],
Cell[59483, 1647, 484, 10, 28, "Message",ExpressionUUID->"56513661-f405-cd4c-beeb-d179b205f7cb"],
Cell[59970, 1659, 652, 13, 28, "Message",ExpressionUUID->"d54bdb4a-8ae3-034c-bf93-e9569b487aab"],
Cell[60625, 1674, 471, 10, 28, "Message",ExpressionUUID->"e070c8d0-2818-564f-b742-d4efa85de394"],
Cell[61099, 1686, 898, 20, 287, "Output",ExpressionUUID->"b2f4cc12-4d05-cb49-b212-2b787c9d751e"]
}, Open  ]]
}, Open  ]]
}
]
*)

